<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>calendario2 - alfredoPuerta DW2E</title>

        <script>

            var meses = ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'];
            var diasMeses = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            var diasSemana = ['L', 'M', 'X', 'J', 'V', 'S', 'D'];

            function iniciar(){
                // var anio = prompt('¿De qué año desea ver el calendario?');
                // mostrarAnio(anio);
                
                for(let i = 2000; i < 2022; i++){
                    var anioCalendario = crearNodo('h2', document.body);
                    anioCalendario.innerHTML = 'Año ' + i;
                    mostrarAnio(i);
                    crearSalto();
                }
                
                mostrarAnio(2019);
            }
            
            //función que muestra cada uno de los meses
            function mostrarAnio(anio){
                //crea los meses con los dias
                for(let i = 0; i < meses.length; i++){
                    var mes = crearNodo('div', document.body, '', 'meses');
                    var mesNombre = crearNodo('div', mes, '', '');
                    mes.style.display = 'block';
                    mes.style.width = '1500px';
                    mes.style.height = '30px';
                    mesNombre.style.float = 'left';
                    mesNombre.style.textAlign = 'right';
                    mesNombre.style.width = '10%';
                    mesNombre.style.fontSize = '24px';
                    mesNombre.innerHTML = meses[i];
                    
                    //crea los dias
                    var k = 0;
                    for(let j = 1; j <= parseInt(diasMeses[i]); j++){
                        var dia = crearNodo('div', mes, '', 'dias');
                        dia.style.width = '30px';
                        dia.style.float = 'left';
                        dia.style.fontSize = '14px';
                        dia.style.textAlign = 'center';
                        dia.style.backgroundColor = 'rgb(250, 250, 180)';
                        if(j > 7){
                            if(k >= 7){k = 0;}
                            dia.innerHTML = j + '<br/>' + diasSemana[k];
                            // dia.innerHTML = j + '<br/>' + fechaCalendario(i)[k];
                            k++;
                        } else {dia.innerHTML = j + '<br/>' + diasSemana[j - 1];}
                        if(dia.innerHTML.includes('S') || dia.innerHTML.includes('D')){dia.style.color = 'red';}
                        dia.addEventListener('click', crearNota);
                        dia.addEventListener('mouseenter', function(){
                            this.style.cursor = 'pointer';
                            this.style.textShadow = '0px 0px 5px black';
                        });
                        dia.addEventListener('mouseout', function(){
                            this.style.textShadow = 'none';
                        });
                    }

                    crearSalto();
                }
            }

            // function fechaCalendario(anio){
            //     var fechaInicial = new Date(anio, 0, 1);
            //     const diaFechaInicial = {
            //         diaSemana: diaSemana[fechaInicial.getDate()],
            //         diaMes: fechaInicial.getDay()
            //     };
            //     var diasMes = [];
            //     diasMes.push(diaMes);
            //     return diasMes.sort(function(a, b){
            //         return a - b;
            //     });

            // }

            //función que crea notas dentro de cada día utilizando el atributo 'title' como almacenamiento.
            function crearNota(){
                if(this.title){
                    var editar = confirm(this.title + '\n\n¿Editar la nota?');
                    if(editar){
                        var nuevaNota = prompt('', this.title);
                        this.title = nuevaNota;
                        if(nuevaNota == ''){this.style.backgroundColor = 'rgb(250, 250, 180)';
                        } else {return;}
                    } else {return;}
                } else {
                    var nota = prompt('Escriba una nota: ');
                    this.title = nota;
                    this.style.backgroundColor = 'yellow';
                }
            }

            //función que crea nodos
            function crearNodo(tipo, padre, id, clase) {
                var nodo = document.createElement(tipo);
                if(id != ''){nodo.id = id;}
                if(clase != ''){nodo.className = clase;}
                padre.appendChild(nodo);
                return nodo;
            }

            //función para crear saltos entre nodos
            function crearSalto() {
                // div vacio sin dimensiones con clear left
                var ele = document.createElement('div'); // crear nodo
                ele.style.clear = 'left'; // css posicionamiento
                document.body.appendChild(ele);	// añadir nodo al dom 
            }

            window.onload = iniciar;
        </script>
    </head>

    <body>
    </body>
</html>